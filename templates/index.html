<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Files name generator</title>
    <style>
        /* Stile semplificato */
        body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; background-color: #f4f4f4; }
        .container { max-width: 600px; margin: auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
        .robot-button { 
            padding: 15px 30px; 
            margin: 10px; 
            font-size: 1.1em; 
            cursor: pointer; 
            border: 1px solid #007bff; 
            border-radius: 4px; 
            background-color: #f8f9fa; 
            color: #007bff; 
            transition: background-color 0.2s;
        }
        .robot-button:hover { 
            background-color: #007bff; 
            color: white; 
        }
        #code-display { 
            font-size: 2em; 
            color: #28a745; 
            margin-top: 30px; 
            padding: 20px; 
            border: 3px solid #28a745; 
            display: none; 
            background-color: #e9ffe9; 
            word-break: break-all;
            user-select: all; 
        }
        button { 
            padding: 12px 25px; 
            font-size: 1.1em; 
            cursor: pointer; 
            margin: 10px; 
            border: none;
            border-radius: 4px;
            background-color: #007bff; 
            color: white; 
            transition: background-color 0.2s;
        }
        button:hover { background-color: #0056b3; }
    </style>
</head>
<body>
    <div class="container">
        
        <div id="selection-view">
            <h1>Select the robot and generate file name</h1>
            
            <button class="robot-button" data-robot-type="ENG" onclick="showGenerator('ENG')">
                Robot Engineering  (ENG)
            </button>
            
            <button class="robot-button" data-robot-type="INF" onclick="showGenerator('INF')">
                Robot Infantry B (INF)
            </button>
            
            </div>

        <div id="generation-view" style="display: none;">
            <h2 id="robot-title"></h2>
            
            <button onclick="generateCode()">Generate New file name</button>
            
            <div id="code-display" title="Click to copy">Click 'Generate New file name'</div>
            
            <button onclick="resetView()">Back to selection</button>
        </div>
    </div>

    <script>
        let selectedRobotType = '';

        function showGenerator(type, name) {
            selectedRobotType = type;
            document.getElementById('robot-title').innerText = `File generator for: ${name} (${type})`;
            document.getElementById('selection-view').style.display = 'none';
            document.getElementById('generation-view').style.display = 'block';
            document.getElementById('code-display').style.display = 'none';
            document.getElementById('code-display').innerText = ''; 
        }

        function resetView() {
            document.getElementById('selection-view').style.display = 'block';
            document.getElementById('generation-view').style.display = 'none';
        }

        async function generateCode() {
            const display = document.getElementById('code-display');
            display.innerText = "Generazione in corso...";
            display.style.display = 'block';
            display.style.color = '#ffc107'; 
            display.style.borderColor = '#ffc107';

            try {
                const response = await fetch('/generate_code', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ robot_type: selectedRobotType })
                });

                const result = await response.json();
                
                if (!response.ok) {
                    throw new Error(result.error || 'Errore nella risposta del server');
                }
                
                // Successo: mostra il codice
                display.innerText = result.code; 
                display.style.color = '#28a745';
                display.style.borderColor = '#28a745';

            } catch (error) {
                console.error('Errore:', error);
                display.innerText = `ERRORE: ${error.message}`;
                display.style.color = '#dc3545'; 
                display.style.borderColor = '#dc3545';
            }
        }
        
        // Funzione per copiare il codice al click
        document.getElementById('code-display').addEventListener('click', function() {
            const code = this.innerText;
            if (code && !code.startsWith('Generazione') && !code.startsWith('ERRORE')) {
                navigator.clipboard.writeText(code).then(() => {
                    const originalText = this.innerText;
                    this.innerText = 'Copiato!';
                    setTimeout(() => { this.innerText = originalText; }, 1000);
                }).catch(err => {
                    console.error('Errore nella copia:', err);
                });
            }
        });
    </script>
</body>
</html>
